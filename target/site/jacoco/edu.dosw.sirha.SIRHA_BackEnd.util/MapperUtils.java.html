<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>MapperUtils.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">SIRHA-BackEnd</a> &gt; <a href="index.source.html" class="el_package">edu.dosw.sirha.SIRHA_BackEnd.util</a> &gt; <span class="el_source">MapperUtils.java</span></div><h1>MapperUtils.java</h1><pre class="source lang-java linenums">package edu.dosw.sirha.SIRHA_BackEnd.util;

import edu.dosw.sirha.SIRHA_BackEnd.domain.model.Student;
import edu.dosw.sirha.SIRHA_BackEnd.dto.StudentDTO;
import java.util.stream.Collectors;

/**
 * Clase utilitaria para la conversión entre entidades del dominio y DTOs (Data Transfer Objects).
 * 
 * Esta clase implementa el patrón Mapper, proporcionando métodos estáticos para convertir
 * objetos del dominio a sus representaciones DTO correspondientes y viceversa.
 * Los DTOs son utilizados para transferir datos entre las diferentes capas de la aplicación,
 * especialmente entre la capa de presentación (controladores) y la capa de servicio.
 * 
 * Ventajas del uso de DTOs:
 * - Encapsulación: Controla qué información se expone externamente
 * - Versionado: Permite evolucionar la API sin afectar el modelo de dominio
 * - Seguridad: Evita exponer información sensible del modelo interno
 * - Performance: Reduce el tamaño de los datos transferidos
 * 
 */
<span class="nc" id="L22">public class MapperUtils {</span>

    /**
     * Convierte una entidad Student del dominio a su representación DTO.
     * 
     * Esta conversión incluye:
     * - Información básica del estudiante (id, username, código)
     * - Lista de IDs de solicitudes asociadas (si existen)
     * - Omite información sensible como el hash de contraseña
     * 
     * @param student la entidad Student del dominio a convertir.
     *               Puede ser null, en cuyo caso se retorna null.
     * @return el DTO correspondiente al estudiante, o null si el parámetro es null
     * 
     * @example
     * &lt;pre&gt;
     * Student student = new Student(&quot;1&quot;, &quot;juan.perez&quot;, &quot;hashedPass&quot;, &quot;ESTUDIANTE&quot;, &quot;202112345&quot;);
     * StudentDTO dto = MapperUtils.toDTO(student);
     * // Resultado:
     * // dto.getId() = &quot;1&quot;
     * // dto.getUsername() = &quot;juan.perez&quot;  
     * // dto.getCodigo() = &quot;202112345&quot;
     * // dto.getSolicitudesIds() = [] 
     * &lt;/pre&gt;
     * 
     * @see StudentDTO
     * @see Student
     */
    public static StudentDTO toDTO(Student student) {
        // Manejo defensivo de null
<span class="fc bfc" id="L52" title="All 2 branches covered.">        if (student == null) {</span>
<span class="fc" id="L53">            return null;</span>
        }

<span class="fc" id="L56">        StudentDTO dto = new StudentDTO();</span>
<span class="fc" id="L57">        dto.setId(student.getId());</span>
<span class="fc" id="L58">        dto.setUsername(student.getUsername());</span>
<span class="fc" id="L59">        dto.setCodigo(student.getCodigo()); </span>

        // Conversión segura de la lista de solicitudes a IDs
<span class="pc bpc" id="L62" title="1 of 2 branches missed.">        if (student.getSolicitudes() != null) {</span>
<span class="fc" id="L63">            dto.setSolicitudesIds(</span>
<span class="fc" id="L64">                student.getSolicitudes().stream()</span>
<span class="pc bnc" id="L65" title="All 2 branches missed.">                        .filter(solicitud -&gt; solicitud != null) // Filtrar nulls</span>
<span class="pc" id="L66">                        .map(solicitud -&gt; solicitud.getId())</span>
<span class="pc bnc" id="L67" title="All 2 branches missed.">                        .filter(id -&gt; id != null) // Filtrar IDs null</span>
<span class="fc" id="L68">                        .collect(Collectors.toList())</span>
            );
<span class="fc" id="L70">        } else {</span>
            // Inicializar con lista vacía si no hay solicitudes
<span class="nc" id="L72">            dto.setSolicitudesIds(java.util.Collections.emptyList());</span>
        }

<span class="fc" id="L75">        return dto;</span>
    }

    /**
     * Convierte un StudentDTO a una entidad Student del dominio.
     * 
     * Esta conversión es útil cuando se reciben datos desde la capa de presentación
     * y necesitan ser convertidos a entidades del dominio para procesamiento
     * en la lógica de negocio.
     * 
     * @param dto el DTO a convertir a entidad del dominio.
     * @return la entidad Student correspondiente
     * @example
     * &lt;pre&gt;
     * StudentDTO dto = new StudentDTO();
     * dto.setId(&quot;1&quot;);
     * dto.setUsername(&quot;maria.garcia&quot;);
     * dto.setCodigo(&quot;202112346&quot;);
     * Student student = MapperUtils.fromDTO(dto);
     * // student.getId() = &quot;1&quot;
     * // student.getUsername() = &quot;maria.garcia&quot;
     * // student.getCodigo() = &quot;202112346&quot;
     * // student.getSolicitudes() = null (debe ser cargado por separado)
     * &lt;/pre&gt;
     */
    public static Student fromDTO(StudentDTO dto) {
<span class="fc bfc" id="L101" title="All 2 branches covered.">        if (dto == null) {</span>
<span class="fc" id="L102">            return null;</span>
        }

        // Crear entidad Student con contraseña por defecto
        // En un escenario real, la contraseña debería ser manejada por separado
<span class="fc" id="L107">        return new Student(</span>
<span class="fc" id="L108">            dto.getId(),</span>
<span class="fc" id="L109">            dto.getUsername(),</span>
<span class="fc" id="L110">            &quot;defaultPassword&quot;, // Contraseña temporal - debe ser actualizada</span>
<span class="fc" id="L111">            &quot;ESTUDIANTE&quot;, // Rol por defecto</span>
<span class="fc" id="L112">            dto.getCodigo()</span>
        );
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>