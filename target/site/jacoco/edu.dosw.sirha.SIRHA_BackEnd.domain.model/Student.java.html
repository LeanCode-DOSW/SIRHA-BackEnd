<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="es"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Student.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">SIRHA-BackEnd</a> &gt; <a href="index.source.html" class="el_package">edu.dosw.sirha.SIRHA_BackEnd.domain.model</a> &gt; <span class="el_source">Student.java</span></div><h1>Student.java</h1><pre class="source lang-java linenums">package edu.dosw.sirha.SIRHA_BackEnd.domain.model;

import java.util.List;
import java.util.ArrayList;
import java.util.Objects;

import org.springframework.data.mongodb.core.mapping.Document;

import com.fasterxml.jackson.databind.JsonSerializable.Base;

import edu.dosw.sirha.SIRHA_BackEnd.domain.model.enums.SemaforoColores;
import edu.dosw.sirha.SIRHA_BackEnd.domain.port.SolicitudFactory;

/**
 * Entidad del dominio que representa a un estudiante en el sistema SIRHA.
 * 
 * Esta clase extiende de User y añade funcionalidades específicas para estudiantes,
 * incluyendo gestión de código estudiantil, plan de estudios, semáforo académico
 * y solicitudes realizadas.
 * 
 * El estudiante es la entidad central del sistema, ya que todas las operaciones
 * principales (inscripciones, cambios de grupo, solicitudes) se realizan en
 * torno a esta entidad.
 * 
 * Características principales:
 * - Hereda propiedades básicas de User (id, username, password, rol)
 * - Tiene un código estudiantil único en el sistema
 * - Posee un plan de estudios asignado
 * - Mantiene un semáforo de estado académico por materia
 * - Gestiona una lista de solicitudes académicas
 * 
 * @see User
 * @see StudyPlan
 * @see Semaforo
 * @see BaseRequest
 */
@Document(collection = &quot;students&quot;)
public class Student extends User implements SolicitudFactory {
    private String codigo;
    private StudyPlan planGeneral;
    private Semaforo semaforo;
    private List&lt;BaseRequest&gt; solicitudes;


    public Student() {
<span class="nc" id="L46">        super();</span>
<span class="nc" id="L47">    }</span>

    /**
     * Constructor principal para crear un nuevo estudiante.
     * 
     * Inicializa un estudiante con los datos básicos requeridos.
     * La lista de solicitudes se inicializa como lista vacía.
     * El plan de estudios y semáforo deben ser asignados posteriormente.
     * 
     * @param id identificador único del estudiante en el sistema.
     *          No debe ser null o vacío.
     * @param username nombre de usuario para acceso al sistema.
     *                Debe ser único. No debe ser null o vacío.
     * @param passwordHash hash de la contraseña del estudiante.
     *                    Debe estar previamente hasheado por seguridad.
     * @param rol rol del usuario en el sistema (típicamente &quot;ESTUDIANTE&quot;).
     *           No debe ser null.
     * @param codigo código estudiantil único.
     *              No debe ser null o vacío.
     * 
     * @throws IllegalArgumentException si algún parámetro requerido es null o vacío
     */
    public Student(String id, String username, String email, String passwordHash, String codigo) {
<span class="fc" id="L70">        super(id, username, email, passwordHash);</span>
<span class="pc bpc" id="L71" title="2 of 4 branches missed.">        if (codigo == null || codigo.trim().isEmpty()) {</span>
<span class="nc" id="L72">            throw new IllegalArgumentException(&quot;El código de estudiante no puede ser null o vacío&quot;);</span>
        }
<span class="fc" id="L74">        this.codigo = codigo;</span>
<span class="fc" id="L75">    }</span>

    /**
     * Agrega una nueva solicitud a la lista del estudiante.
     * 
     * Añade una solicitud académica (cambio de grupo, cambio de materia, etc.)
     * a la lista de solicitudes del estudiante. La solicitud debe estar
     * completamente inicializada antes de agregarla.
     * 
     * @param solicitud la solicitud a agregar. No debe ser null.
     * @throws IllegalArgumentException si la solicitud es null
     */
    public void agregarSolicitud(BaseRequest solicitud) {
<span class="nc bnc" id="L88" title="All 2 branches missed.">        if (solicitud == null) {</span>
<span class="nc" id="L89">            throw new IllegalArgumentException(&quot;La solicitud no puede ser null&quot;);</span>
        }
        
<span class="nc bnc" id="L92" title="All 2 branches missed.">        if (this.solicitudes == null) {</span>
<span class="nc" id="L93">            this.solicitudes = new ArrayList&lt;&gt;();</span>
        }
        
<span class="nc" id="L96">        this.solicitudes.add(solicitud);</span>
<span class="nc" id="L97">    }</span>

    /**
     * Obtiene el código estudiantil.
     * @return código único del estudiante
     */
    public String getCodigo() {
<span class="fc" id="L104">        return codigo;</span>
    }

    /**
     * Establece el código estudiantil.
     * @param codigo nuevo código del estudiante. No debe ser null o vacío.
     * @throws IllegalArgumentException si el código es null o vacío
     */
    public void setCodigo(String codigo) {
<span class="pc bpc" id="L113" title="2 of 4 branches missed.">        if (codigo == null || codigo.trim().isEmpty()) {</span>
<span class="nc" id="L114">            throw new IllegalArgumentException(&quot;El código no puede ser null o vacío&quot;);</span>
        }
<span class="fc" id="L116">        this.codigo = codigo;</span>
<span class="fc" id="L117">    }</span>

    /**
     * Obtiene el plan de estudios asignado.
     * @return plan de estudios del estudiante, puede ser null si no se ha asignado
     */
    public StudyPlan getPlanGeneral() {
<span class="nc" id="L124">        return planGeneral;</span>
    }

    /**
     * Establece el plan de estudios del estudiante.
     * @param planGeneral nuevo plan de estudios a asignar
     */
    public void setPlanGeneral(StudyPlan planGeneral) {
<span class="nc" id="L132">        this.planGeneral = planGeneral;</span>
<span class="nc" id="L133">    }</span>

    /**
     * Obtiene el semáforo académico del estudiante.
     * @return semáforo académico, puede ser null si no se ha inicializado
     */
    public Semaforo getSemaforo() {
<span class="fc" id="L140">        return semaforo;</span>
    }

    /**
     * Establece el semáforo académico del estudiante.
     * @param semaforo nuevo semáforo a asignar
     */
    public void setSemaforo(Semaforo semaforo) {
<span class="fc" id="L148">        this.semaforo = semaforo;</span>
<span class="fc" id="L149">    }</span>

    /**
     * Obtiene la lista de solicitudes del estudiante.
     * @return lista de solicitudes, nunca null (inicializada como lista vacía)
     */
    public List&lt;BaseRequest&gt; getSolicitudes() {
<span class="fc bfc" id="L156" title="All 2 branches covered.">        if (solicitudes == null) {</span>
<span class="fc" id="L157">            solicitudes = new ArrayList&lt;&gt;();</span>
        }
<span class="fc" id="L159">        return solicitudes;</span>
    }

    /**
     * Establece la lista completa de solicitudes del estudiante.
     * @param solicitudes nueva lista de solicitudes. Si es null, se inicializa como lista vacía.
     */
    public void setSolicitudes(List&lt;BaseRequest&gt; solicitudes) {
<span class="nc bnc" id="L167" title="All 2 branches missed.">        this.solicitudes = solicitudes != null ? solicitudes : new ArrayList&lt;&gt;();</span>
<span class="nc" id="L168">    }</span>

    /**
     * Compara este estudiante con otro objeto para determinar igualdad.
     * Dos estudiantes son iguales si tienen el mismo código.
     * 
     * @param obj objeto a comparar
     * @return true si los objetos son iguales, false en caso contrario
     */
    @Override
    public boolean equals(Object obj) {
<span class="fc bfc" id="L179" title="All 2 branches covered.">        if (this == obj) return true;</span>
<span class="pc bpc" id="L180" title="2 of 4 branches missed.">        if (obj == null || getClass() != obj.getClass()) return false;</span>
<span class="pc bpc" id="L181" title="1 of 2 branches missed.">        if (!super.equals(obj)) return false;</span>
        
<span class="nc" id="L183">        Student student = (Student) obj;</span>
<span class="nc" id="L184">        return Objects.equals(codigo, student.codigo);</span>
    }

    /**
     * Genera el hash code del estudiante basado en su código.
     * @return hash code del estudiante
     */
    @Override
    public int hashCode() {
<span class="nc" id="L193">        return Objects.hash(super.hashCode(), codigo);</span>
    }

    /**
     * Representación en string del estudiante.
     * @return string con información básica del estudiante
     */
    @Override
    public String toString() {
<span class="fc" id="L202">        return String.format(&quot;Student{id='%s', username='%s', codigo='%s', numSolicitudes=%d}&quot;, </span>
<span class="fc" id="L203">                            getId(), getUsername(), codigo, </span>
<span class="pc bpc" id="L204" title="1 of 2 branches missed.">                            solicitudes != null ? solicitudes.size() : 0);</span>
    }

    

    /**
     * @return 
     * 
     */
    public BaseRequest requestConstructor(Subject previousSubject, Group previousGroup, Subject newSubject, Group newGroup, String motivo) {
<span class="nc" id="L214">        ArrayList&lt;BaseRequest&gt; requests = (ArrayList&lt;BaseRequest&gt;) this.getSolicitudes();</span>
<span class="nc bnc" id="L215" title="All 4 branches missed.">        if (previousSubject.equals(newSubject)|| !previousGroup.equals(newGroup)) {</span>
<span class="nc" id="L216">            CambioGrupo request = new CambioGrupo(previousSubject, previousGroup, newSubject, newGroup, motivo,requests.size()+1,this);</span>
<span class="nc" id="L217">            solicitudes.add(request);</span>
<span class="nc" id="L218">            return request;</span>
        } else{
<span class="nc" id="L220">            CambioMateria request = new CambioMateria(previousSubject, previousGroup, newSubject, newGroup, motivo,requests.size()+1,this);</span>
<span class="nc" id="L221">            solicitudes.add(request);</span>
<span class="nc" id="L222">            return request;</span>
        }
    }
} 

</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.12.202403310830</span></div></body></html>